{"version":3,"sources":["../src/Container.js"],"names":[],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;IAEa,S,WAAA,S;;;;;;;;;;;mCACE,M,EAAQ;AAAA;;AACf,gBAAI,WAAW,EAAf;AACA,gBAAI,WAAW,EAAf;AACA,mBAAO,OAAO,SAAP,CAAiB,UAAC,KAAD,EAAW;AAC/B,oBAAM,SAAS,OAAK,KAAL,gBAAW,QAAX,EAAqB,QAArB,4BAAkC,KAAlC,GAAf;AACA,uBAAQ,OAAO,MAAP,KAAkB,CAAnB,GACH,uBAAW,EAAX,CAAc,KAAd,CADG,GAEH,uBAAW,aAAX,CACI,WAAW,MADf,EAEI;AAAA,sDAAI,IAAJ;AAAI,4BAAJ;AAAA;;AAAA,wDAAiB,KAAjB,GAA2B,IAA3B;AAAA,iBAFJ,CAFJ;AAMH,aARM,CAAP;AASH;;;8BACK,Q,EAAU,Q,EAAU,M,EAAQ,M,EAAoB;AAAA,gBAAZ,KAAY,yDAAJ,EAAI;AAAA,8BAIvB,KAJuB,CAG9C,IAH8C;AAAA,gBAG9C,IAH8C,+BAGvC,CAHuC;AAAA,4BAIvB,KAJuB,CAI9C,EAJ8C;AAAA,gBAI9C,EAJ8C,6BAIzC,OAAO,MAJkC;;AAKlD,gBAAI,QAAQ,CAAC,CAAb;AACA,gBAAI,QAAQ,KAAK,IAAjB;;AAEA,mBAAO,EAAE,KAAF,IAAW,KAAlB,EAAyB;AACrB,oBAAI,CAAC,SAAS,KAAT,CAAL,EAAsB;AAClB,6BAAS,KAAT,IAAkB,sCAAlB;AACA,6BAAS,KAAT,IAAkB,KAAK,WAAL,CACd,SAAS,KAAT,CADc,EACG,KADH,EACU,OAAO,KAAP,CADV,CAAlB;AAGH;AACJ;;AAED,oBAAQ,QAAQ,CAAhB;AACA,qBAAS,MAAT,GAAkB,KAAlB;AACA,oBAAQ,SAAS,MAAjB;AACA,mBAAO,EAAE,KAAF,GAAU,KAAjB,EAAwB;AACpB,yBAAS,KAAT,EAAgB,QAAhB;AACH;;AAED,oBAAQ,CAAC,CAAT;AACA,oBAAQ,SAAS,MAAT,GAAkB,SAAS,MAAnC;AACA,mBAAO,EAAE,KAAF,GAAU,KAAjB,EAAwB;AACpB,oBAAM,QAAQ,OAAO,QAAQ,IAAf,CAAd;AACA,oBAAI,SAAS,QAAO,KAAP,yCAAO,KAAP,OAAiB,QAA9B,EAAwC;AACpC,wBAAM,QAAQ,OAAO,KAAP,CAAa,KAAb,CAAd;AACA,6BAAS,KAAT,EAAgB,IAAhB,CAAqB,KAArB;AACH;AACJ;;AAED,mBAAO,QAAP;AACH","file":"Container.js","sourcesContent":["import { Component } from './Component';\nimport { Observable } from 'rxjs/Observable';\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\n\nexport class Container extends Component {\n    initialize(models) {\n        var subjects = [];\n        var children = [];\n        return models.switchMap((tuple) => {\n            const active = this.deref(subjects, children, ...tuple);\n            return (active.length === 0) ?\n                Observable.of(tuple) :\n                Observable.combineLatest(\n                    children = active,\n                    (...kids) => [...tuple, ...kids]\n                );\n        });\n    }\n    deref(subjects, children, _model, _state, range = {}) {\n\n        const {\n            from = 0,\n            to = _state.length } = range;\n        let index = -1;\n        let count = to - from;\n\n        while (++index <= count) {\n            if (!subjects[index]) {\n                subjects[index] = new BehaviorSubject();\n                children[index] = this.createChild(\n                    subjects[index], index, _state[index]\n                );\n            }\n        }\n\n        index = count - 1;\n        children.length = count;\n        count = subjects.length;\n        while (++index < count) {\n            subjects[index].complete();\n        }\n\n        index = -1;\n        count = subjects.length = children.length;\n        while (++index < count) {\n            const state = _state[index + from];\n            if (state && typeof state === 'object') {\n                const model = _model.deref(state);\n                subjects[index].next(model);\n            }\n        }\n\n        return children;\n    }\n}\n"]}